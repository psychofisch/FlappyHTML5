<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1">
        <script src="jquery-3.2.1.min.js"></script>
        <style type="text/css">
            body {
              margin:0; padding: 0; border:0; background: black;
                overflow: hidden;
            }

            div {
              position: absolute; margin: 0; padding: 0; border: 0;
                outline:0; color:white;
            }

            .sprite{
              background-image:url(sheet.png);
            }

            #viewport {
              width: 100%; height: 100%; overflow: hidden;
              top: 0px; left: 0px; margin: 0;
              background-color: lightblue;
              z-index: 0;
            }

            #bird {
              width: 34px;
              height: 24px;
              background-position: -312px -230px;
              z-index: 2;
              animation: cycle_sprites 300ms steps(1) infinite,
                                move_bird 5s linear infinite;
            }

            #start {
              background-position: -318px -382px;
              width: 80px;
              height: 28px;
              z-index: 3;
            }

            @keyframes cycle_sprites {
                0% { background-position: -312px -230px; }
                33.33% { background-position: -312px -256px;}
                66.66% { background-position: -312px -282px;}
            }

            @keyframes move_bird {
                from { left: 0px}
                to { left: 500px}
            }
        </style>
    </head>
    <body>
      <script type="text/javascript">
        //classes
        function Vec2()
        {
          this.x = 0;
          this.y = 0;
        }

        function Bird()
        {
          this.velocity = new Vec2();
          this.position = new Vec2();
          this.reference = undefined;
        }

        function Resize()
        {
          viewportSize.x = $("#viewport").height();
          viewportSize.y = $("#viewport").width();
          $("#start").css({"top": viewportSize.x * 0.5 - 40, "left": viewportSize.y * 0.5 - 14});
          console.log("resize!");
        }

        //some init stuff
        var bird = new Bird(),
            gamePause = false,
            viewportSize = new Vec2(),
            startBtn;

        //handler
        $(document).ready(function() {
          init();
        });

        $(window).resize(Resize);

        function init(){
          Resize();
          bird.reference = $("#bird");
          startBtn = $("#start");

          startBtn.on("click", startGame);

          $("body").keydown(function(event)
          {
            //console.log(event);
            switch(event.key)
            {
              case "Escape": gamePause = !gamePause;
              break;
            }
          });
        }

        //logic
        function resetGame()
        {
          bird.position.x = 0;
          bird.position.y = 0;
        }

        function startGame()
        {
          startBtn.hide();

          $("#viewport").on("click", click);

          bird.position.x = viewportSize.x * 0.5;
          bird.velocity.x = 1;

          setTimeout(gameLoop, 32);
        }

        function click()
        {
          if(!gamePause)
            bird.velocity.x = -15;
        }

        function gameLoop()
        {
          setTimeout(gameLoop, 32);

          if(gamePause)
            return;

          //physics
          if(bird.velocity.x <= 100)
            bird.velocity.x += 1;
          bird.position.x += bird.velocity.x;

          //logic
          if(bird.position.x >= 500)
            bird.position.x = 0;

          bird.reference.css("top", bird.position.x);
          //bird.reference.animate({top: bird.position.x}, 32);
        }
      </script>
        <div id="viewport">
            <div class="sprite" id="start"></div>
            <div class="sprite" id="bird"></div>
            <div id="sprite1" class="sprite" style="
                left:0px;
                top:300px;
                background-position: -0px -410px;
                width: 276px;
                height: 200px;
                z-index: 1;
            "></div>
        </div>
    </body>
</html>
